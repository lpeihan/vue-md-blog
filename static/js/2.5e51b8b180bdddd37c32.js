webpackJsonp([2],{e9pe:function(s,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var v=t("o3ZJ"),n=t("18Nq"),e=Object(n.a)(null,v.a,v.b,!1,null,null,null);a.default=e.exports},ga2z:function(s,a,t){s.exports=t("e9pe")},o3ZJ:function(s,a,t){"use strict";t.d(a,"a",function(){return v}),t.d(a,"b",function(){return n});var v=function(){var s=this,a=s.$createElement;s._self._c;return s._m(0)},n=[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("p",[s._v("{"),t("br"),s._v("  “title”: “promise”,"),t("br"),s._v("  “tags”: “javascript mongo redis webpack node koa express”,"),t("br"),s._v("  “date”: “2018-03-01”"),t("br"),s._v("}")]),s._v(" "),t("ul",[t("li",[s._v("概念")])]),s._v(" "),t("p",[t("code",[s._v("Promise")]),s._v("是异步编程的一种解决方案，比传统的解决方案（回调函数和事件）更合理更强大，能优雅解决回调地狱难题。")]),s._v(" "),t("p",[s._v("所谓"),t("code",[s._v("Promise")]),s._v("，简单说就是一个容器，里面保存着某个未来才会结束的事件的结果。")]),s._v(" "),t("p",[t("code",[s._v("Promise")]),s._v("对象代表一个异步操作，有三种状态："),t("code",[s._v("Pending(进行中)")]),s._v("、"),t("code",[s._v("Resolved(已完成)")]),s._v("和"),t("code",[s._v("Rejected(已失败)")]),s._v("。只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是"),t("code",[s._v("Promise")]),s._v("这个名字的由来，它的英语意思就是“承诺”，表示其他手段无法改变。 ")]),s._v(" "),t("ul",[t("li",[s._v("基本用法")])]),s._v(" "),t("p",[t("code",[s._v("Promise")]),s._v("构造函数接受一个函数作为参数，该函数的两个参数分别是"),t("code",[s._v("resolve")]),s._v("和"),t("code",[s._v("reject")]),s._v("。")]),s._v(" "),t("p",[t("code",[s._v("resolve")]),s._v("将"),t("code",[s._v("Promise")]),s._v("对象的状态从从"),t("code",[s._v("Pending")]),s._v("变为"),t("code",[s._v("Resolved")]),s._v("，在异步操作成功时调用，并将异步操作的结果，作为参数传递出去。")]),s._v(" "),t("p",[t("code",[s._v("reject")]),s._v("函数的作用是，在异步操作失败时调用，并将异步操作报出的错误，作为参数传递出去。")]),s._v(" "),t("p",[t("code",[s._v("Promise")]),s._v("实例生成以后，可以用"),t("code",[s._v("then")]),s._v("方法分别制定"),t("code",[s._v("Resolved")]),s._v("状态和"),t("code",[s._v("Rejected")]),s._v("状态的回调函数。")]),s._v(" "),t("pre",[t("code",{staticClass:"lang-javascript"},[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" promise = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-comment"},[s._v("// ... some code")]),s._v("\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-comment"},[s._v("/* 异步操作成功 */")]),s._v(") {\n    resolve(value);\n  } "),t("span",{staticClass:"hljs-keyword"},[s._v("else")]),s._v(" {\n    reject(error);\n  }\n});\n"),t("p",[s._v("promise.then("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("value")]),s._v(") ")]),s._v("{\n"),t("span",{staticClass:"hljs-comment"},[s._v("// sucess")]),s._v("\n}, "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("error")]),s._v(") ")]),s._v("{\n"),t("span",{staticClass:"hljs-comment"},[s._v("// failure")]),s._v("\n});\n")])])]),t("p"),s._v(" "),t("ul",[t("li",[t("code",[s._v("Promise")]),s._v("新建后会立即执行")])]),s._v(" "),t("pre",[t("code",{staticClass:"lang-javascript"},[t("span",{staticClass:"hljs-keyword"},[s._v("const")]),s._v(" promise = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n  "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("'promise'")]),s._v(");\n  resolve();\n});\n"),t("p",[s._v("promise.then("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"}),s._v(") ")]),s._v("{\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("'resolve'")]),s._v(");\n});")]),s._v("\n"),t("p",[t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-string"},[s._v("'hi'")]),s._v(");")]),s._v("\n"),t("p",[t("span",{staticClass:"hljs-comment"},[s._v("// promise")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// hi")]),s._v("\n"),t("span",{staticClass:"hljs-comment"},[s._v("// resolve")]),s._v("\n")])])]),t("p"),s._v(" "),t("p",[s._v("上面代码中，"),t("code",[s._v("new Promise")]),s._v("后立即执行，先输出的是"),t("code",[s._v("promise")]),s._v("，"),t("code",[s._v("then")]),s._v("方法的回调函数将在当前脚本所有同步任务执行完才会执行，所以"),t("code",[s._v("resolve")]),s._v("最后输出。")]),s._v(" "),t("ul",[t("li",[s._v("多任务并行处理")])]),s._v(" "),t("p",[s._v("当多个异步任务没有依赖关系，且要等多个异步任务全部返回后才执行相应的回调函数，"),t("code",[s._v("Promise")]),s._v("也可以优雅的解决 。")]),s._v(" "),t("pre",[t("code",{staticClass:"lang-javascript"},[t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v(".all([\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n    setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("()")]),s._v(" =>")]),s._v(" {\n      resolve("),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(");\n    }, "),t("span",{staticClass:"hljs-number"},[s._v("1000")]),s._v(");\n  }),\n  "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" "),t("span",{staticClass:"hljs-built_in"},[s._v("Promise")]),s._v("("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("resolve, reject")]),s._v(") ")]),s._v("{\n    setTimeout("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("()")]),s._v(" =>")]),s._v(" {\n      resolve("),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v(");\n    }, "),t("span",{staticClass:"hljs-number"},[s._v("2000")]),s._v(");\n  })\n])\n  .then("),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("results")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(results); "),t("span",{staticClass:"hljs-comment"},[s._v("// [1, 2]")]),s._v("\n  });\n")])])])}]}});
//# sourceMappingURL=2.5e51b8b180bdddd37c32.js.map